---
title: System Cleanup
description: >
  Removes leftover scheduled tasks, clears residual caches, and deletes
  orphaned system directories. Telemetry tasks are in privacy.yml;
  comprehensive file/cache/log cleanup is in CLEANUP.ps1 via finalize.yml.

actions:
  # =======================================================================
  # SCHEDULED TASKS — APPLICATION EXPERIENCE (non-telemetry)
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\StartupAppTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\PcaPatchDbTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Application Experience\SdbinstMergeDbTask', operation: delete, errorAction: log}
  # UCPD velocity (User Connected Platform Devices telemetry)
  - !scheduledTask: {path: '\Microsoft\Windows\AppxDeploymentClient\UCPD velocity', operation: delete, errorAction: log}
  # =======================================================================
  # SCHEDULED TASKS — CUSTOMER EXPERIENCE (non-telemetry)
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — DIAGNOSTICS
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticResolver', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — MAPS & LOCATION
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Maps\MapsToastTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Maps\MapsUpdateTask', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — CLOUD & SYNC
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\CloudExperienceHost\CreateObjectTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\SettingSync\BackupTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\SettingSync\NetworkStateChangeTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\SettingSync\BackgroundUploadTask', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — MAINTENANCE & MISC
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Maintenance\WinSAT', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeSystem', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\FamilySafetyMonitor', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\FamilySafetyRefresh', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Shell\FamilySafetyRefreshTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\License Manager\TempSignedLicenseExchange', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Clip\License Validation', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\ApplicationData\DsSvcCleanup', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\RetailDemo\CleanupOfflineContent', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\LocalUserSyncDataAvailable', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\MouseSyncDataAvailable', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\PenSyncDataAvailable', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Input\TouchpadSyncDataAvailable', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\International\Synchronize Language Settings', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\MemoryDiagnostic\ProcessMemoryDiagnosticEvents', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\MemoryDiagnostic\RunFullMemoryDiagnostic', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\MUI\LPRemove', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Registry\RegIdleBackup', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — SPEECH & HANDWRITING
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Speech\SpeechModelDownloadTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\InputPersonalization\TrainDataUploader', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — HELLO FACE & BIOMETRICS
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\HelloFace\FODCleanupTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\BioEnrollment\*', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — WINDOWS DEFENDER (already removed)
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Cache Maintenance', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Cleanup', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Scheduled Scan', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Windows Defender\Windows Defender Verification', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\ExploitGuard\ExploitGuard MDM policy Refresh', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — EDGE & OFFICE
  # =======================================================================

  - !scheduledTask: {path: '\MicrosoftEdgeUpdateTaskMachineCore', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\MicrosoftEdgeUpdateTaskMachineUA', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Setup\EOSNotify', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Setup\EOSNotify2', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Setup\SetupCleanupTask', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — XBOX
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\XblGameSave\XblGameSaveTask', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\XblGameSave\XblGameSaveTaskLogon', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — UPDATE RESIDUALS
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\Schedule Scan Static Task', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\USO_UxBroker', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\UpdateOrchestrator\UpdateModelTask', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — AI & COPILOT
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\WindowsAI\*', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Workplace Join\*', operation: delete, errorAction: log}

  # =======================================================================
  # SCHEDULED TASKS — DEVICE INFORMATION & MANAGEMENT
  # =======================================================================

  - !scheduledTask: {path: '\Microsoft\Windows\Device Information\Device', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Device Information\Device User', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Management\Provisioning\Cellular', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\Flighting\*', operation: delete, errorAction: log}
  - !scheduledTask: {path: '\Microsoft\Windows\PushToInstall\*', operation: delete, errorAction: log}

  # =======================================================================
  # FILE CLEANUP — MINIMAL PRE-PASS
  # Comprehensive cleanup in CLEANUP.ps1 via finalize.yml.
  # Only items NOT covered by CLEANUP.ps1 are included here.
  # =======================================================================

  # Clear icon cache (not in CLEANUP.ps1)
  - !cmd: {command: 'del /f /q "%LOCALAPPDATA%\IconCache.db" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'del /f /q "%LOCALAPPDATA%\Microsoft\Windows\Explorer\iconcache_*.db" 2>nul', wait: true, weight: 5, errorAction: log}

  # Clear thumbnail cache (not in CLEANUP.ps1)
  - !cmd: {command: 'del /f /q "%LOCALAPPDATA%\Microsoft\Windows\Explorer\thumbcache_*.db" 2>nul', wait: true, weight: 5, errorAction: log}

  # Clean RetailDemo offline content (not in CLEANUP.ps1)
  - !cmd: {command: 'rd /s /q "%SYSTEMROOT%\RetailDemo" 2>nul', wait: true, weight: 5, errorAction: log}

  # Clear Prefetch (not in CLEANUP.ps1)
  - !cmd: {command: 'del /s /f /q "%SYSTEMROOT%\Prefetch\*" 2>nul', wait: true, weight: 5, errorAction: log}

  # Remove WindowsAI / Recall data folder
  - !cmd: {command: 'rd /s /q "%LOCALAPPDATA%\Packages\MicrosoftWindows.Client.AIX_cw5n1h2txyewy" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'rd /s /q "%ProgramData%\Microsoft\Windows\AppRepository\Packages\MicrosoftWindows.Client.AIX*" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'rd /s /q "%ProgramFiles%\WindowsApps\MicrosoftWindows.Client.AIX*" 2>nul', wait: true, weight: 5, errorAction: log}

  # Remove leftover Copilot / BingChat directories
  - !cmd: {command: 'rd /s /q "%LOCALAPPDATA%\Microsoft\BingChat" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'rd /s /q "%LOCALAPPDATA%\Microsoft\Edge Copilot" 2>nul', wait: true, weight: 5, errorAction: log}

  # Remove leftover Windows Defender directories
  - !cmd: {command: 'rd /s /q "%ProgramData%\Microsoft\Windows Defender" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'rd /s /q "%ProgramFiles%\Windows Defender" 2>nul', wait: true, weight: 5, errorAction: log}
  - !cmd: {command: 'rd /s /q "%ProgramFiles(x86)%\Windows Defender" 2>nul', wait: true, weight: 5, errorAction: log}
